<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-style/core-style.html">
<link rel="import" href="../bower_components/core-header-panel/core-header-panel.html"/>
<link rel="import" href="../bower_components/core-toolbar/core-toolbar.html"/>

<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="../bower_components/paper-dropdown/paper-dropdown.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">


<core-style id="monitor-matrix">
    :host {
        display: inline-block;
        height: 230px;
        width: calc({{ 100 / g.columns }}% - 10px);
        margin: 2px;
        -webkit-user-select: text;
    }
</core-style>

<script>
    CoreStyle.g.columns = 3;
</script>

<polymer-element name="monitor-matrix" attributes="monitor" monitor="{{monitor}}">
    <template>
        <style>
            section {
                overflow-y: auto;
                overflow-x: auto;
                height: 100%;
                padding: 5px;
            }

            core-header-panel {
                height: 100%;
            }

            .core-header {
                height: 40px;
                line-height: 40px;
                font-size: 16px;
                background-color: #424242;
                color: #FFF;
                transition: height 0.2s;
                padding-left: 10px;
            }
        </style>
        <core-style ref="monitor-matrix"></core-style>
        <core-header-panel mode="seamed">
            <div class="core-header" layout horizontal>
                <span flex>{{monitor.profile.name}}</span>
                <span>
                    <paper-menu-button>
                        <paper-icon-button icon="menu" noink></paper-icon-button>
                        <paper-dropdown class="dropdown" layered>
                            <core-menu>
                                <paper-item noink on-click="{{close}}">Close</paper-item>
                                <paper-item noink on-click="{{clear}}">Clear</paper-item>
                            </core-menu>
                        </paper-dropdown>
                    </paper-menu-button>
                </span>
            </div>
            <section>
                <template repeat="{{log in monitor.logs}}">
                    <div>{{log}}</div>
                </template>
            </section>
        </core-header-panel>
    </template>
    <script>
        Polymer({
            monitor: null,
            clear: function () {
                this.monitor.clear();
            },
            close: function() {
                this.asyncFire('core-signal', {name: "close-monitor", data: this.monitor});
            },
        });
    </script>
</polymer-element>
